import{r as a,u as G,a as m,N as H,O as J,P as Q,j as X,k as K,l as W,m as Y,q as Z,s as $,x as ee,y as te,z as ue,A as oe,B as le,C as se,D as ne,E as ae,G as de,H as re,e as Ce,_ as ie,I as ce,o as i,c,b as e,f as r,w as _,v,i as P,F as R,d as N,t as C,Q as _e,g as V,J as pe,L as De,p as me,h as ve}from"./index-23063745.js";function ge(p){return new URL(Object.assign({"/src/assets/images/강아지이미지.jpg":X,"/src/assets/images/검정 후드티.jpg":K,"/src/assets/images/검정 후드티2.jpg":W,"/src/assets/images/검정 후드티3.jpg":Y,"/src/assets/images/고양이 이미지.png":Z,"/src/assets/images/나이키 바지.jpg":$,"/src/assets/images/마이페이지.png":ee,"/src/assets/images/슬랙스.jpg":te,"/src/assets/images/야구 잠바.jpg":ue,"/src/assets/images/양털 후리스.jpg":oe,"/src/assets/images/청바지.jpg":le,"/src/assets/images/체크셔츠.jpg":se,"/src/assets/images/파란색 후드티.jpg":ne,"/src/assets/images/패딩 조끼.jpg":ae,"/src/assets/images/회색 후드티.jpg":de,"/src/assets/images/회색 후드티2.jpg":re})[`/src/assets/images/${p}`],self.location).href}const he={setup(){const p=a([]),o=a(),b=G(),t=a([]),B=a("배송 시 요청사항을 선택해주세요"),k=a("card"),F=a(!1),u=a(""),D=a(""),f=a(""),I=a(""),j=a(""),x=a(""),A=a(),g=a(0),E=a(0);m.get("/api/selectAddrList").then(s=>{p.value=s.data}).catch(s=>{if(console.log(s),s.response.status===500){alert("서버 오류 발생");return}});const z=s=>s.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),q=s=>{m.get("/api/selectAddrInfo",{params:{addrId:s}}).then(n=>{o.value=n.data}).catch(n=>{if(console.log(n),n.response.status===500){alert("서버 오류 발생");return}})},U=a([]);H(async()=>{const s=b.query.products;if(s){const d=s.toString().split(",").map(Number);U.value=d}const n={ids:U.value.join(",")};try{await m.get("api/selectCartProduct",{params:n}).then(d=>{t.value=d.data;let y=0;d.data.forEach(h=>{y+=h.price*h.cnt*.01}),E.value=y}).catch(d=>{if(d.response.status===500){alert("서버 오류 발생");return}})}catch(d){console.error("Error fetching products:",d)}});const L=async()=>{if(o.value==null)alert("배송지를 선택 해주세요");else{if(B.value==="배송 시 요청사항을 선택해주세요"){alert("요청사항을 선택해주세요");return}if(window.confirm("결제하시겠습니까?")){const n={name:o.value.name,addr:o.value.addr,addrDetail:o.value.addrDetail,phone:o.value.phone,zipcode:o.value.zipcode,req:B.value,price:M.value,paymentMethod:k.value,reservesPlus:E.value,reservesMinus:g.value,reserves:g.value};try{const d=await m.post("/api/order",n);if(console.log(d),d.data!==-1){const y=d.data,h=[];t.value.forEach(w=>{const T={orderId:y,productId:w.productId,price:w.price,cnt:w.cnt};h.push(T)}),(await m.post("/api/orderDetail",h)).data==="success"?(console.log("주문이 성공적으로 완료되었습니다."),Ce.push({name:"OrderListView",query:{id:b.query.id}})):console.error("상세 주문 정보 저장 실패")}else console.error("주문 저장 실패")}catch(d){console.error("주문 처리 중 오류 발생:",d)}}}},M=J(()=>t.value.reduce((s,n)=>s+n.cnt*n.price,0)),O=()=>{new window.daum.Postcode({oncomplete:s=>{u.value=s.zonecode,D.value=s.roadAddress}}).open()},S=()=>{if(I.value===""){alert("수령인을 입력해주세요");return}if(x.value===""){alert("휴대전화를 입력해주세요");return}if(u.value===""){alert("우편번호를 입력해주세요");return}if(D.value===""){alert("주소를 입력해주세요");return}if(f.value===""){alert("상세주소를 입력해주세요");return}const s={name:I.value,addrName:j.value,phone:x.value,zipcode:u.value,addr:D.value,addrDetail:f.value};m.post("api/insertAddr",s).then(n=>{n.data==="success"&&location.reload()}).catch(n=>{if(console.log(n),n.response.data==="fail"){alert("주소 등록 실패");return}if(n.response.status===500){alert("서버 오류 발생");return}}),console.log(s)};return m.get("/api/selectReserves").then(s=>{console.log(s),A.value=s.data}).catch(s=>{if(console.log(s),s.response.status===500){alert("서버 오류 발생");return}}),Q(g,s=>{A.value!==void 0&&s>A.value.reserves&&(alert("현재 적립금보다 많이 사용할 수 없습니다."),g.value=0)}),{addrList:p,addRadio:q,addrInfo:o,productList:t,getImageUrl:ge,paymentBtn:L,getTotalPrice:M,req:B,payMethod:k,modal:F,zonecode:u,roadAddress:D,detailAddress:f,openPostcode:O,name:I,addrName:j,phone:x,saveAddr:S,addCommas:z,reservesInfo:A,useReserves:g,reserves:E}}};const l=p=>(me("data-v-6b754e85"),p=p(),ve(),p),Be={key:0,class:"black-bg"},fe={class:"white-bg"},Ae=l(()=>e("h1",null,"신규 배송지",-1)),ye=l(()=>e("span",null,"수령인",-1)),be=l(()=>e("br",null,null,-1)),ke=l(()=>e("span",null,"배송지명 (선택)",-1)),Fe=l(()=>e("br",null,null,-1)),Ie=l(()=>e("span",null,"휴대전화",-1)),xe=l(()=>e("br",null,null,-1)),Ee=l(()=>e("span",null,"배송지 주소",-1)),we=l(()=>e("br",null,null,-1)),Ve=l(()=>e("span",null,null,-1)),je=l(()=>e("br",null,null,-1)),Ue=l(()=>e("span",null,null,-1)),Me=l(()=>e("hr",null,null,-1)),Pe=l(()=>e("h1",null,"Order / Payment",-1)),Re=l(()=>e("legend",null,"배송지 정보",-1)),Ne=l(()=>e("label",{for:"addr",class:"title"},"배송지",-1)),ze=["onClick"],qe=l(()=>e("label",{for:"tel2",class:"title"},"이름 / 연락처",-1)),Le={key:0},Oe={key:1},Se=l(()=>e("label",{for:"comment",class:"title"},"주소",-1)),Te={key:0},Ge={key:1},He=l(()=>e("label",{for:"comment",class:"title"},"배송 요청사항",-1)),Je=l(()=>e("option",{value:"배송 시 요청사항을 선택해주세요"}," 배송 시 요청사항을 선택해주세요 ",-1)),Qe=l(()=>e("option",{value:"부재 시 경비실에 맡겨주세요"},"부재 시 경비실에 맡겨주세요",-1)),Xe=l(()=>e("option",{value:"부재 시 택배함에 넣어주세요"},"부재 시 택배함에 넣어주세요",-1)),Ke=l(()=>e("option",{value:"부재 시 집 앞에 놔주세요"},"부재 시 집 앞에 놔주세요",-1)),We=[Je,Qe,Xe,Ke],Ye=l(()=>e("legend",null,"주문 정보",-1)),Ze=l(()=>e("thead",null,[e("tr",null,[e("th",null,"상품정보"),e("th",null,"수량"),e("th",null,"적립금"),e("th",null,"상품 할인"),e("th",null,"배송 그룹"),e("th",null,"배송비"),e("th",null,"주문금액")])],-1)),$e={class:"item-info"},et=["src"],tt=l(()=>e("br",null,null,-1)),ut=l(()=>e("td",null,"-0원",-1)),ot=l(()=>e("td",null,"무료",-1)),lt=l(()=>e("legend",null,"적립금 할인",-1)),st={key:0},nt=l(()=>e("legend",null,"결제 정보",-1)),at={style:{"padding-right":"10px"}},dt={style:{"padding-right":"10px"}},rt={style:{"padding-right":"10px"}},Ct={class:"centered"};function it(p,o,b,t,B,k){const F=ce("router-link");return i(),c("div",null,[t.modal===!0?(i(),c("div",Be,[e("div",fe,[e("button",{type:"button",onClick:o[0]||(o[0]=u=>t.modal=!1),style:{float:"right"}},"X"),Ae,e("label",null,[ye,r(),_(e("input",{type:"text","onUpdate:modelValue":o[1]||(o[1]=u=>t.name=u)},null,512),[[v,t.name]])]),r(),be,e("label",null,[ke,r(),_(e("input",{type:"text","onUpdate:modelValue":o[2]||(o[2]=u=>t.addrName=u)},null,512),[[v,t.addrName]])]),r(),Fe,e("label",null,[Ie,r(),_(e("input",{type:"text","onUpdate:modelValue":o[3]||(o[3]=u=>t.phone=u)},null,512),[[v,t.phone]])]),r(),xe,e("label",null,[Ee,_(e("input",{type:"text",placeholder:"우편번호","onUpdate:modelValue":o[4]||(o[4]=u=>t.zonecode=u),readonly:""},null,512),[[v,t.zonecode]]),e("button",{id:"postcode",onClick:o[5]||(o[5]=(...u)=>t.openPostcode&&t.openPostcode(...u))},"검색"),we,Ve,_(e("input",{type:"text","onUpdate:modelValue":o[6]||(o[6]=u=>t.roadAddress=u),placeholder:"주소",readonly:""},null,512),[[v,t.roadAddress]]),je,Ue,_(e("input",{type:"text","onUpdate:modelValue":o[7]||(o[7]=u=>t.detailAddress=u),placeholder:"상세주소"},null,512),[[v,t.detailAddress]])]),Me,e("button",{type:"button",onClick:o[8]||(o[8]=u=>t.modal=!1),style:{"margin-right":"10px"}},"취소"),e("button",{type:"button",onClick:o[9]||(o[9]=(...u)=>t.saveAddr&&t.saveAddr(...u))},"저장")])])):P("",!0),Pe,e("form",null,[e("fieldset",null,[Re,e("ul",null,[e("li",null,[Ne,(i(!0),c(R,null,N(t.addrList,(u,D)=>(i(),c("span",{key:D},[e("label",null,[e("input",{type:"radio",name:"chk_info",onClick:f=>t.addRadio(u.addrId)},null,8,ze),r(" "+C(u.addrName),1)])]))),128)),e("button",{type:"button",style:{"margin-left":"10px"},onClick:o[10]||(o[10]=u=>t.modal=!0)}," 신규 배송지 추가 ")]),e("li",null,[qe,t.addrInfo?(i(),c("p",Le,C(t.addrInfo.name)+" / "+C(t.addrInfo.phone),1)):(i(),c("p",Oe,"선택해주세요"))]),e("li",null,[Se,t.addrInfo?(i(),c("p",Te," ("+C(t.addrInfo.zipcode)+") "+C(t.addrInfo.addr)+" "+C(t.addrInfo.addrDetail),1)):(i(),c("p",Ge,"선택해주세요"))]),e("li",null,[He,_(e("select",{style:{width:"300px"},"onUpdate:modelValue":o[11]||(o[11]=u=>t.req=u)},We,512),[[_e,t.req]])])])]),e("fieldset",null,[Ye,e("table",null,[Ze,e("tbody",null,[(i(!0),c(R,null,N(t.productList,(u,D)=>(i(),c("tr",{key:D,class:"cart-item"},[e("td",$e,[pe(F,{to:{name:"productDetailView",query:{id:u.productId}}},{default:De(()=>[e("span",null,[e("img",{src:t.getImageUrl(u.img),style:{width:"80px"}},null,8,et)]),tt]),_:2},1032,["to"]),r(" "+C(u.name),1)]),e("td",null,C(u.cnt)+"개",1),e("td",null,C(t.addCommas(u.cnt*u.price*.01))+"원",1),ut,e("td",null,"그룹"+C(D+1),1),ot,e("td",null,C(t.addCommas(u.cnt*u.price))+"원",1)]))),128))])])]),e("fieldset",null,[lt,r(" 적립금 사용: "),_(e("input",{type:"text","onUpdate:modelValue":o[12]||(o[12]=u=>t.useReserves=u)},null,512),[[v,t.useReserves]]),r(" 현재 적립금 : "),t.reservesInfo?(i(),c("span",st,C(t.reservesInfo.reserves),1)):P("",!0)]),e("fieldset",null,[nt,e("label",at,[_(e("input",{type:"radio",name:"chk_info1",value:"card",checked:"","onUpdate:modelValue":o[13]||(o[13]=u=>t.payMethod=u)},null,512),[[V,t.payMethod]]),r("카드")]),e("label",dt,[_(e("input",{type:"radio",name:"chk_info1",value:"account","onUpdate:modelValue":o[14]||(o[14]=u=>t.payMethod=u)},null,512),[[V,t.payMethod]]),r("가상계좌")]),e("label",rt,[_(e("input",{type:"radio",name:"chk_info1",value:"phone","onUpdate:modelValue":o[15]||(o[15]=u=>t.payMethod=u)},null,512),[[V,t.payMethod]]),r("휴대폰")])]),e("div",Ct,[e("button",{onClick:o[16]||(o[16]=(...u)=>t.paymentBtn&&t.paymentBtn(...u)),type:"button",style:{cursor:"pointer","font-size":"20px",padding:"10px 20px",color:"white","background-color":"black"}},C(t.addCommas(t.getTotalPrice-t.useReserves))+"원 결제하기 ",1)])])])}const pt=ie(he,[["render",it],["__scopeId","data-v-6b754e85"]]);export{pt as default};
