import{r as s,u as G,a as m,J as H,K as J,L as K,i as X,j as Q,k as W,l as Y,m as Z,n as $,q as ee,s as te,x as oe,y as ue,z as le,A as ne,B as se,e as ae,_ as de,D as re,o as i,c,b as e,f as d,w as _,v,C as M,F as R,d as P,t as r,M as Ce,g as I,G as ie,H as ce,p as _e,h as pe}from"./index-f74d7f36.js";function De(p){return new URL(Object.assign({"/src/assets/images/검정 후드티.jpg":X,"/src/assets/images/검정 후드티2.jpg":Q,"/src/assets/images/검정 후드티3.jpg":W,"/src/assets/images/나이키 바지.jpg":Y,"/src/assets/images/마이페이지.png":Z,"/src/assets/images/슬랙스.jpg":$,"/src/assets/images/야구 잠바.jpg":ee,"/src/assets/images/양털 후리스.jpg":te,"/src/assets/images/청바지.jpg":oe,"/src/assets/images/체크셔츠.jpg":ue,"/src/assets/images/패딩 조끼.jpg":le,"/src/assets/images/회색 후드티.jpg":ne,"/src/assets/images/회색 후드티2.jpg":se})[`/src/assets/images/${p}`],self.location).href}const me={setup(){const p=s([]),u=s(),f=G(),t=s([]),g=s("배송 시 요청사항을 선택해주세요"),y=s("card"),b=s(!1),o=s(""),D=s(""),h=s(""),k=s(""),w=s(""),F=s(""),B=s(),A=s(0);m.get("/api/selectAddrList").then(n=>{p.value=n.data}).catch(n=>{console.log(n)});const z=n=>n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),N=n=>{m.post("/api/selectAddrInfo",{addrId:n}).then(a=>{u.value=a.data}).catch(a=>{console.log(a)})},E=s([]);H(async()=>{const n=f.query.products;if(n){const C=n.toString().split(",").map(Number);E.value=C}const a={ids:E.value.join(",")};try{const C=await m.get("api/selectCartProduct",{params:a});t.value=C.data}catch(C){console.error("Error fetching products:",C)}});const q=async()=>{if(u.value==null)alert("배송지를 선택 해주세요");else{if(g.value==="배송 시 요청사항을 선택해주세요"){alert("요청사항을 선택해주세요");return}if(window.confirm("결제하시겠습니까?")){const a={name:u.value.name,addr:u.value.addr,addrDetail:u.value.addrDetail,phone:u.value.phone,zipcode:u.value.zipcode,req:g.value,price:V.value-A.value,paymentMethod:y.value};try{const C=await m.post("/api/order",a);if(console.log(C),C.data!==-1){const O=C.data,j=[];t.value.forEach(x=>{const T={orderId:O,productId:x.productId,price:x.price,cnt:x.cnt};j.push(T)});const U=await m.post("/api/orderDetail",j);console.log(U),U.data==="success"?(console.log("주문이 성공적으로 완료되었습니다."),ae.push({name:"OrderListView",query:{id:f.query.id}})):console.error("상세 주문 정보 저장 실패")}else console.error("주문 저장 실패")}catch(C){console.error("주문 처리 중 오류 발생:",C)}}}},V=J(()=>t.value.reduce((n,a)=>n+a.cnt*a.price,0)),L=()=>{new window.daum.Postcode({oncomplete:n=>{o.value=n.zonecode,D.value=n.roadAddress}}).open()},S=()=>{if(k.value===""){alert("수령인을 입력해주세요");return}if(F.value===""){alert("휴대전화를 입력해주세요");return}if(o.value===""){alert("우편번호를 입력해주세요");return}if(D.value===""){alert("주소를 입력해주세요");return}if(h.value===""){alert("상세주소를 입력해주세요");return}const n={name:k.value,addrName:w.value,phone:F.value,zipcode:o.value,addr:D.value,addrDetail:h.value};m.post("api/insertAddr",n).then(a=>{a.data==="success"&&location.reload()}).catch(a=>{console.log(a)}),console.log(n)};return m.get("/api/selectReserves").then(n=>{console.log(n),B.value=n.data}).catch(n=>{console.log(n)}),K(A,n=>{B.value!==void 0&&n>B.value.reserves&&(alert("현재 적립금보다 많이 사용할 수 없습니다."),A.value=0)}),{addrList:p,addRadio:N,addrInfo:u,productList:t,getImageUrl:De,paymentBtn:q,getTotalPrice:V,req:g,payMethod:y,modal:b,zonecode:o,roadAddress:D,detailAddress:h,openPostcode:L,name:k,addrName:w,phone:F,saveAddr:S,addCommas:z,reservesInfo:B,useReserves:A}}};const l=p=>(_e("data-v-b64c57d5"),p=p(),pe(),p),ve={key:0,class:"black-bg"},ge={class:"white-bg"},he=l(()=>e("h1",null,"신규 배송지",-1)),Be=l(()=>e("span",null,"수령인",-1)),Ae=l(()=>e("br",null,null,-1)),fe=l(()=>e("span",null,"배송지명 (선택)",-1)),ye=l(()=>e("br",null,null,-1)),be=l(()=>e("span",null,"휴대전화",-1)),ke=l(()=>e("br",null,null,-1)),Fe=l(()=>e("span",null,"배송지 주소",-1)),xe=l(()=>e("br",null,null,-1)),Ie=l(()=>e("span",null,null,-1)),we=l(()=>e("br",null,null,-1)),Ee=l(()=>e("span",null,null,-1)),Ve=l(()=>e("hr",null,null,-1)),je=l(()=>e("h1",null,"Order / Payment",-1)),Ue=l(()=>e("legend",null,"배송지 정보",-1)),Me=l(()=>e("label",{for:"addr",class:"title"},"배송지",-1)),Re=["onClick"],Pe=l(()=>e("label",{for:"tel2",class:"title"},"이름 / 연락처",-1)),ze={key:0},Ne={key:1},qe=l(()=>e("label",{for:"comment",class:"title"},"주소",-1)),Le={key:0},Se={key:1},Oe=l(()=>e("label",{for:"comment",class:"title"},"배송 요청사항",-1)),Te=l(()=>e("option",{value:"배송 시 요청사항을 선택해주세요"}," 배송 시 요청사항을 선택해주세요 ",-1)),Ge=l(()=>e("option",{value:"부재 시 경비실에 맡겨주세요"},"부재 시 경비실에 맡겨주세요",-1)),He=l(()=>e("option",{value:"부재 시 택배함에 넣어주세요"},"부재 시 택배함에 넣어주세요",-1)),Je=l(()=>e("option",{value:"부재 시 집 앞에 놔주세요"},"부재 시 집 앞에 놔주세요",-1)),Ke=[Te,Ge,He,Je],Xe=l(()=>e("legend",null,"주문 정보",-1)),Qe=l(()=>e("thead",null,[e("tr",null,[e("th",null,"상품정보"),e("th",null,"수량"),e("th",null,"적립금"),e("th",null,"상품 할인"),e("th",null,"배송 그룹"),e("th",null,"배송비"),e("th",null,"주문금액")])],-1)),We={class:"item-info"},Ye=["src"],Ze=l(()=>e("br",null,null,-1)),$e=l(()=>e("td",null,"-0원",-1)),et=l(()=>e("td",null,"무료",-1)),tt=l(()=>e("legend",null,"적립금 할인",-1)),ot={key:0},ut=l(()=>e("legend",null,"결제 정보",-1)),lt={style:{"padding-right":"10px"}},nt={style:{"padding-right":"10px"}},st={style:{"padding-right":"10px"}},at={class:"centered"};function dt(p,u,f,t,g,y){const b=re("router-link");return i(),c("div",null,[t.modal===!0?(i(),c("div",ve,[e("div",ge,[e("button",{type:"button",onClick:u[0]||(u[0]=o=>t.modal=!1),style:{float:"right"}},"X"),he,e("label",null,[Be,d(),_(e("input",{type:"text","onUpdate:modelValue":u[1]||(u[1]=o=>t.name=o)},null,512),[[v,t.name]])]),d(),Ae,e("label",null,[fe,d(),_(e("input",{type:"text","onUpdate:modelValue":u[2]||(u[2]=o=>t.addrName=o)},null,512),[[v,t.addrName]])]),d(),ye,e("label",null,[be,d(),_(e("input",{type:"text","onUpdate:modelValue":u[3]||(u[3]=o=>t.phone=o)},null,512),[[v,t.phone]])]),d(),ke,e("label",null,[Fe,_(e("input",{type:"text",placeholder:"우편번호","onUpdate:modelValue":u[4]||(u[4]=o=>t.zonecode=o),readonly:""},null,512),[[v,t.zonecode]]),e("button",{id:"postcode",onClick:u[5]||(u[5]=(...o)=>t.openPostcode&&t.openPostcode(...o))},"검색"),xe,Ie,_(e("input",{type:"text","onUpdate:modelValue":u[6]||(u[6]=o=>t.roadAddress=o),placeholder:"주소",readonly:""},null,512),[[v,t.roadAddress]]),we,Ee,_(e("input",{type:"text","onUpdate:modelValue":u[7]||(u[7]=o=>t.detailAddress=o),placeholder:"상세주소"},null,512),[[v,t.detailAddress]])]),Ve,e("button",{type:"button",onClick:u[8]||(u[8]=o=>t.modal=!1),style:{"margin-right":"10px"}},"취소"),e("button",{type:"button",onClick:u[9]||(u[9]=(...o)=>t.saveAddr&&t.saveAddr(...o))},"저장")])])):M("",!0),je,e("form",null,[e("fieldset",null,[Ue,e("ul",null,[e("li",null,[Me,(i(!0),c(R,null,P(t.addrList,(o,D)=>(i(),c("span",{key:D},[e("label",null,[e("input",{type:"radio",name:"chk_info",onClick:h=>t.addRadio(o.addrId)},null,8,Re),d(" "+r(o.addrName),1)])]))),128)),e("button",{type:"button",style:{"margin-left":"10px"},onClick:u[10]||(u[10]=o=>t.modal=!0)}," 신규 배송지 추가 ")]),e("li",null,[Pe,t.addrInfo?(i(),c("p",ze,r(t.addrInfo.name)+" / "+r(t.addrInfo.phone),1)):(i(),c("p",Ne,"선택해주세요"))]),e("li",null,[qe,t.addrInfo?(i(),c("p",Le," ("+r(t.addrInfo.zipcode)+") "+r(t.addrInfo.addr)+" "+r(t.addrInfo.addrDetail),1)):(i(),c("p",Se,"선택해주세요"))]),e("li",null,[Oe,_(e("select",{style:{width:"300px"},"onUpdate:modelValue":u[11]||(u[11]=o=>t.req=o)},Ke,512),[[Ce,t.req]])])])]),e("fieldset",null,[Xe,e("table",null,[Qe,e("tbody",null,[(i(!0),c(R,null,P(t.productList,(o,D)=>(i(),c("tr",{key:D,class:"cart-item"},[e("td",We,[ie(b,{to:{name:"productDetailView",query:{id:o.productId}}},{default:ce(()=>[e("span",null,[e("img",{src:t.getImageUrl(o.img),style:{width:"80px"}},null,8,Ye)]),Ze]),_:2},1032,["to"]),d(" "+r(o.name),1)]),e("td",null,r(o.cnt)+"개",1),e("td",null,r(t.addCommas(o.cnt*o.price*.01))+"원",1),$e,e("td",null,"그룹"+r(D+1),1),et,e("td",null,r(t.addCommas(o.cnt*o.price))+"원",1)]))),128))])])]),e("fieldset",null,[tt,d(" 적립금 사용: "),_(e("input",{type:"text","onUpdate:modelValue":u[12]||(u[12]=o=>t.useReserves=o)},null,512),[[v,t.useReserves]]),d(" 현재 적립금 : "),t.reservesInfo?(i(),c("span",ot,r(t.reservesInfo.reserves),1)):M("",!0)]),e("fieldset",null,[ut,e("label",lt,[_(e("input",{type:"radio",name:"chk_info1",value:"card",checked:"","onUpdate:modelValue":u[13]||(u[13]=o=>t.payMethod=o)},null,512),[[I,t.payMethod]]),d("카드")]),e("label",nt,[_(e("input",{type:"radio",name:"chk_info1",value:"account","onUpdate:modelValue":u[14]||(u[14]=o=>t.payMethod=o)},null,512),[[I,t.payMethod]]),d("가상계좌")]),e("label",st,[_(e("input",{type:"radio",name:"chk_info1",value:"phone","onUpdate:modelValue":u[15]||(u[15]=o=>t.payMethod=o)},null,512),[[I,t.payMethod]]),d("휴대폰")])]),e("div",at,[e("button",{onClick:u[16]||(u[16]=(...o)=>t.paymentBtn&&t.paymentBtn(...o)),type:"button",style:{cursor:"pointer","font-size":"20px",padding:"10px 20px",color:"white","background-color":"black"}},r(t.addCommas(t.getTotalPrice-t.useReserves))+"원 결제하기 ",1)])])])}const Ct=de(me,[["render",dt],["__scopeId","data-v-b64c57d5"]]);export{Ct as default};
