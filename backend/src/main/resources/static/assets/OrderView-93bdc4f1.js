import{H as K,r as a,u as Q,a as D,e as h,O as X,P as W,Q as Y,l as Z,m as $,q as ee,s as te,x as oe,y as ue,z as se,A as le,B as ne,C as ae,D as de,E as re,G as ie,I as Ce,J as ce,K as _e,_ as pe,f as z,o as C,c,b as e,g as N,h as r,w as _,v,k as q,F as j,d as L,t as i,R as me,i as M,M as De,p as ve,j as ge}from"./index-ecfce85c.js";function he(p){return new URL(Object.assign({"/src/assets/images/강아지이미지.jpg":Z,"/src/assets/images/검정 후드티.jpg":$,"/src/assets/images/검정 후드티2.jpg":ee,"/src/assets/images/검정 후드티3.jpg":te,"/src/assets/images/고양이 이미지.png":oe,"/src/assets/images/나이키 바지.jpg":ue,"/src/assets/images/마이페이지.png":se,"/src/assets/images/슬랙스.jpg":le,"/src/assets/images/야구 잠바.jpg":ne,"/src/assets/images/양털 후리스.jpg":ae,"/src/assets/images/청바지.jpg":de,"/src/assets/images/체크셔츠.jpg":re,"/src/assets/images/파란색 후드티.jpg":ie,"/src/assets/images/패딩 조끼.jpg":Ce,"/src/assets/images/회색 후드티.jpg":ce,"/src/assets/images/회색 후드티2.jpg":_e})[`/src/assets/images/${p}`],self.location).href}const Be={components:{HeaderView:K},setup(){const p=a([]),u=a(),k=Q(),t=a([]),A=a("배송 시 요청사항을 선택해주세요"),I=a("card"),w=a(!1),g=a(""),o=a(""),m=a(""),y=a(""),R=a(""),x=a(""),b=a(),B=a(0),E=a(0);D.get("/api/selectAddrList").then(l=>{p.value=l.data}).catch(l=>{if(console.log(l),l.response.status===500){h.push("errorForm");return}});const O=l=>l.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),S=l=>{D.get("/api/selectAddrInfo",{params:{addrId:l}}).then(n=>{u.value=n.data}).catch(n=>{if(console.log(n),n.response.status===500){h.push("errorForm");return}})},U=a([]);X(async()=>{const l=k.query.products;if(l){const d=l.toString().split(",").map(Number);U.value=d}const n={ids:U.value.join(",")};try{await D.get("api/selectCartProduct",{params:n}).then(d=>{t.value=d.data;let F=0;d.data.forEach(f=>{F+=f.price*f.cnt*.01}),E.value=F}).catch(d=>{if(d.response.status===500){h.push("errorForm");return}})}catch(d){console.error("Error fetching products:",d)}});const H=async()=>{if(u.value==null)alert("배송지를 선택 해주세요");else{if(A.value==="배송 시 요청사항을 선택해주세요"){alert("요청사항을 선택해주세요");return}if(window.confirm("결제하시겠습니까?")){const n={name:u.value.name,addr:u.value.addr,addrDetail:u.value.addrDetail,phone:u.value.phone,zipcode:u.value.zipcode,req:A.value,price:P.value,paymentMethod:I.value,reservesPlus:E.value,reservesMinus:B.value,reserves:B.value};try{const d=await D.post("/api/order",n);if(console.log(d),d.data!==-1){const F=d.data,f=[];t.value.forEach(V=>{const J={orderId:F,productId:V.productId,price:V.price,cnt:V.cnt};f.push(J)}),(await D.post("/api/orderDetail",f)).data==="success"?(console.log("주문이 성공적으로 완료되었습니다."),h.push({name:"OrderListView",query:{id:k.query.id}})):console.error("상세 주문 정보 저장 실패")}else console.error("주문 저장 실패")}catch(d){console.error("주문 처리 중 오류 발생:",d)}}}},P=W(()=>t.value.reduce((l,n)=>l+n.cnt*n.price,0)),T=()=>{new window.daum.Postcode({oncomplete:l=>{g.value=l.zonecode,o.value=l.roadAddress}}).open()},G=()=>{if(y.value===""){alert("수령인을 입력해주세요");return}if(x.value===""){alert("휴대전화를 입력해주세요");return}if(g.value===""){alert("우편번호를 입력해주세요");return}if(o.value===""){alert("주소를 입력해주세요");return}if(m.value===""){alert("상세주소를 입력해주세요");return}const l={name:y.value,addrName:R.value,phone:x.value,zipcode:g.value,addr:o.value,addrDetail:m.value};D.post("api/insertAddr",l).then(n=>{n.data==="success"&&location.reload()}).catch(n=>{if(console.log(n),n.response.data==="fail"){alert("주소 등록 실패");return}if(n.response.status===500){h.push("errorForm");return}}),console.log(l)};return D.get("/api/selectReserves").then(l=>{console.log(l),b.value=l.data}).catch(l=>{if(console.log(l),l.response.status===500){h.push("errorForm");return}}),Y(B,l=>{b.value!==void 0&&l>b.value.reserves&&(alert("현재 적립금보다 많이 사용할 수 없습니다."),B.value=0)}),{addrList:p,addRadio:S,addrInfo:u,productList:t,getImageUrl:he,paymentBtn:H,getTotalPrice:P,req:A,payMethod:I,modal:w,zonecode:g,roadAddress:o,detailAddress:m,openPostcode:T,name:y,addrName:R,phone:x,saveAddr:G,addCommas:O,reservesInfo:b,useReserves:B,reserves:E}}};const s=p=>(ve("data-v-92539a8a"),p=p(),ge(),p),fe={key:0,class:"black-bg"},Ae={class:"white-bg"},ye=s(()=>e("h1",null,"신규 배송지",-1)),be=s(()=>e("span",null,"수령인",-1)),Fe=s(()=>e("br",null,null,-1)),ke=s(()=>e("span",null,"배송지명 (선택)",-1)),Ie=s(()=>e("br",null,null,-1)),we=s(()=>e("span",null,"휴대전화",-1)),xe=s(()=>e("br",null,null,-1)),Ee=s(()=>e("span",null,"배송지 주소",-1)),Ve=s(()=>e("br",null,null,-1)),je=s(()=>e("span",null,null,-1)),Me=s(()=>e("br",null,null,-1)),Re=s(()=>e("span",null,null,-1)),Ue=s(()=>e("hr",null,null,-1)),Pe=s(()=>e("h1",null,"Order / Payment",-1)),ze=s(()=>e("legend",null,"배송지 정보",-1)),Ne=s(()=>e("label",{for:"addr",class:"title"},"배송지",-1)),qe=["onClick"],Le=s(()=>e("label",{for:"tel2",class:"title"},"이름 / 연락처",-1)),Oe={key:0},Se={key:1},He=s(()=>e("label",{for:"comment",class:"title"},"주소",-1)),Te={key:0},Ge={key:1},Je=s(()=>e("label",{for:"comment",class:"title"},"배송 요청사항",-1)),Ke=s(()=>e("option",{value:"배송 시 요청사항을 선택해주세요"}," 배송 시 요청사항을 선택해주세요 ",-1)),Qe=s(()=>e("option",{value:"부재 시 경비실에 맡겨주세요"},"부재 시 경비실에 맡겨주세요",-1)),Xe=s(()=>e("option",{value:"부재 시 택배함에 넣어주세요"},"부재 시 택배함에 넣어주세요",-1)),We=s(()=>e("option",{value:"부재 시 집 앞에 놔주세요"},"부재 시 집 앞에 놔주세요",-1)),Ye=[Ke,Qe,Xe,We],Ze=s(()=>e("legend",null,"주문 정보",-1)),$e=s(()=>e("thead",null,[e("tr",null,[e("th",null,"상품정보"),e("th",null,"수량"),e("th",null,"적립금"),e("th",null,"상품 할인"),e("th",null,"배송 그룹"),e("th",null,"배송비"),e("th",null,"주문금액")])],-1)),et={class:"item-info"},tt=["src"],ot=s(()=>e("br",null,null,-1)),ut=s(()=>e("td",null,"-0원",-1)),st=s(()=>e("td",null,"무료",-1)),lt=s(()=>e("legend",null,"적립금 할인",-1)),nt={key:0},at=s(()=>e("legend",null,"결제 정보",-1)),dt={style:{"padding-right":"10px"}},rt={style:{"padding-right":"10px"}},it={style:{"padding-right":"10px"}},Ct={class:"centered"};function ct(p,u,k,t,A,I){const w=z("HeaderView"),g=z("router-link");return C(),c(j,null,[e("header",null,[N(w)]),e("div",null,[t.modal===!0?(C(),c("div",fe,[e("div",Ae,[e("button",{type:"button",onClick:u[0]||(u[0]=o=>t.modal=!1),style:{float:"right"}},"X"),ye,e("label",null,[be,r(),_(e("input",{type:"text","onUpdate:modelValue":u[1]||(u[1]=o=>t.name=o)},null,512),[[v,t.name]])]),r(),Fe,e("label",null,[ke,r(),_(e("input",{type:"text","onUpdate:modelValue":u[2]||(u[2]=o=>t.addrName=o)},null,512),[[v,t.addrName]])]),r(),Ie,e("label",null,[we,r(),_(e("input",{type:"text","onUpdate:modelValue":u[3]||(u[3]=o=>t.phone=o)},null,512),[[v,t.phone]])]),r(),xe,e("label",null,[Ee,_(e("input",{type:"text",placeholder:"우편번호","onUpdate:modelValue":u[4]||(u[4]=o=>t.zonecode=o),readonly:""},null,512),[[v,t.zonecode]]),e("button",{id:"postcode",onClick:u[5]||(u[5]=(...o)=>t.openPostcode&&t.openPostcode(...o))},"검색"),Ve,je,_(e("input",{type:"text","onUpdate:modelValue":u[6]||(u[6]=o=>t.roadAddress=o),placeholder:"주소",readonly:""},null,512),[[v,t.roadAddress]]),Me,Re,_(e("input",{type:"text","onUpdate:modelValue":u[7]||(u[7]=o=>t.detailAddress=o),placeholder:"상세주소"},null,512),[[v,t.detailAddress]])]),Ue,e("button",{type:"button",onClick:u[8]||(u[8]=o=>t.modal=!1),style:{"margin-right":"10px"}},"취소"),e("button",{type:"button",onClick:u[9]||(u[9]=(...o)=>t.saveAddr&&t.saveAddr(...o))},"저장")])])):q("",!0),Pe,e("form",null,[e("fieldset",null,[ze,e("ul",null,[e("li",null,[Ne,(C(!0),c(j,null,L(t.addrList,(o,m)=>(C(),c("span",{key:m},[e("label",null,[e("input",{type:"radio",name:"chk_info",onClick:y=>t.addRadio(o.addrId)},null,8,qe),r(" "+i(o.addrName),1)])]))),128)),e("button",{type:"button",style:{"margin-left":"10px"},onClick:u[10]||(u[10]=o=>t.modal=!0)}," 신규 배송지 추가 ")]),e("li",null,[Le,t.addrInfo?(C(),c("p",Oe,i(t.addrInfo.name)+" / "+i(t.addrInfo.phone),1)):(C(),c("p",Se,"선택해주세요"))]),e("li",null,[He,t.addrInfo?(C(),c("p",Te," ("+i(t.addrInfo.zipcode)+") "+i(t.addrInfo.addr)+" "+i(t.addrInfo.addrDetail),1)):(C(),c("p",Ge,"선택해주세요"))]),e("li",null,[Je,_(e("select",{style:{width:"300px"},"onUpdate:modelValue":u[11]||(u[11]=o=>t.req=o)},Ye,512),[[me,t.req]])])])]),e("fieldset",null,[Ze,e("table",null,[$e,e("tbody",null,[(C(!0),c(j,null,L(t.productList,(o,m)=>(C(),c("tr",{key:m,class:"cart-item"},[e("td",et,[N(g,{to:{name:"productDetailView",query:{id:o.productId}}},{default:De(()=>[e("span",null,[e("img",{src:t.getImageUrl(o.img),style:{width:"80px"}},null,8,tt)]),ot]),_:2},1032,["to"]),r(" "+i(o.name),1)]),e("td",null,i(o.cnt)+"개",1),e("td",null,i(t.addCommas(o.cnt*o.price*.01))+"원",1),ut,e("td",null,"그룹"+i(m+1),1),st,e("td",null,i(t.addCommas(o.cnt*o.price))+"원",1)]))),128))])])]),e("fieldset",null,[lt,r(" 적립금 사용: "),_(e("input",{type:"text","onUpdate:modelValue":u[12]||(u[12]=o=>t.useReserves=o)},null,512),[[v,t.useReserves]]),r(" 현재 적립금 : "),t.reservesInfo?(C(),c("span",nt,i(t.reservesInfo.reserves),1)):q("",!0)]),e("fieldset",null,[at,e("label",dt,[_(e("input",{type:"radio",name:"chk_info1",value:"card",checked:"","onUpdate:modelValue":u[13]||(u[13]=o=>t.payMethod=o)},null,512),[[M,t.payMethod]]),r("카드")]),e("label",rt,[_(e("input",{type:"radio",name:"chk_info1",value:"account","onUpdate:modelValue":u[14]||(u[14]=o=>t.payMethod=o)},null,512),[[M,t.payMethod]]),r("가상계좌")]),e("label",it,[_(e("input",{type:"radio",name:"chk_info1",value:"phone","onUpdate:modelValue":u[15]||(u[15]=o=>t.payMethod=o)},null,512),[[M,t.payMethod]]),r("휴대폰")])]),e("div",Ct,[e("button",{onClick:u[16]||(u[16]=(...o)=>t.paymentBtn&&t.paymentBtn(...o)),type:"button",style:{cursor:"pointer","font-size":"20px",padding:"10px 20px",color:"white","background-color":"black"}},i(t.addCommas(t.getTotalPrice-t.useReserves))+"원 결제하기 ",1)])])])],64)}const mt=pe(Be,[["render",ct],["__scopeId","data-v-92539a8a"]]);export{mt as default};
