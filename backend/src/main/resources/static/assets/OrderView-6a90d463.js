import{H as J,r as a,u as K,a as m,O as Q,P as X,Q as W,l as Y,m as Z,q as $,s as ee,x as te,y as ue,z as oe,A as le,B as se,C as ne,D as ae,E as de,G as re,I as ie,J as Ce,K as ce,e as _e,_ as pe,f as P,o as C,c,b as e,g as z,h as r,w as _,v,k as N,F as V,d as q,t as i,R as De,i as j,M as me,p as ve,j as ge}from"./index-6da869ab.js";function he(p){return new URL(Object.assign({"/src/assets/images/강아지이미지.jpg":Y,"/src/assets/images/검정 후드티.jpg":Z,"/src/assets/images/검정 후드티2.jpg":$,"/src/assets/images/검정 후드티3.jpg":ee,"/src/assets/images/고양이 이미지.png":te,"/src/assets/images/나이키 바지.jpg":ue,"/src/assets/images/마이페이지.png":oe,"/src/assets/images/슬랙스.jpg":le,"/src/assets/images/야구 잠바.jpg":se,"/src/assets/images/양털 후리스.jpg":ne,"/src/assets/images/청바지.jpg":ae,"/src/assets/images/체크셔츠.jpg":de,"/src/assets/images/파란색 후드티.jpg":re,"/src/assets/images/패딩 조끼.jpg":ie,"/src/assets/images/회색 후드티.jpg":Ce,"/src/assets/images/회색 후드티2.jpg":ce})[`/src/assets/images/${p}`],self.location).href}const fe={components:{HeaderView:J},setup(){const p=a([]),o=a(),k=K(),t=a([]),B=a("배송 시 요청사항을 선택해주세요"),F=a("card"),I=a(!1),g=a(""),u=a(""),D=a(""),A=a(""),M=a(""),w=a(""),y=a(),h=a(0),x=a(0);m.get("/api/selectAddrList").then(s=>{p.value=s.data}).catch(s=>{if(console.log(s),s.response.status===500){alert("서버 오류 발생");return}});const L=s=>s.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),O=s=>{m.get("/api/selectAddrInfo",{params:{addrId:s}}).then(n=>{o.value=n.data}).catch(n=>{if(console.log(n),n.response.status===500){alert("서버 오류 발생");return}})},R=a([]);Q(async()=>{const s=k.query.products;if(s){const d=s.toString().split(",").map(Number);R.value=d}const n={ids:R.value.join(",")};try{await m.get("api/selectCartProduct",{params:n}).then(d=>{t.value=d.data;let b=0;d.data.forEach(f=>{b+=f.price*f.cnt*.01}),x.value=b}).catch(d=>{if(d.response.status===500){alert("서버 오류 발생");return}})}catch(d){console.error("Error fetching products:",d)}});const S=async()=>{if(o.value==null)alert("배송지를 선택 해주세요");else{if(B.value==="배송 시 요청사항을 선택해주세요"){alert("요청사항을 선택해주세요");return}if(window.confirm("결제하시겠습니까?")){const n={name:o.value.name,addr:o.value.addr,addrDetail:o.value.addrDetail,phone:o.value.phone,zipcode:o.value.zipcode,req:B.value,price:U.value,paymentMethod:F.value,reservesPlus:x.value,reservesMinus:h.value,reserves:h.value};try{const d=await m.post("/api/order",n);if(console.log(d),d.data!==-1){const b=d.data,f=[];t.value.forEach(E=>{const G={orderId:b,productId:E.productId,price:E.price,cnt:E.cnt};f.push(G)}),(await m.post("/api/orderDetail",f)).data==="success"?(console.log("주문이 성공적으로 완료되었습니다."),_e.push({name:"OrderListView",query:{id:k.query.id}})):console.error("상세 주문 정보 저장 실패")}else console.error("주문 저장 실패")}catch(d){console.error("주문 처리 중 오류 발생:",d)}}}},U=X(()=>t.value.reduce((s,n)=>s+n.cnt*n.price,0)),H=()=>{new window.daum.Postcode({oncomplete:s=>{g.value=s.zonecode,u.value=s.roadAddress}}).open()},T=()=>{if(A.value===""){alert("수령인을 입력해주세요");return}if(w.value===""){alert("휴대전화를 입력해주세요");return}if(g.value===""){alert("우편번호를 입력해주세요");return}if(u.value===""){alert("주소를 입력해주세요");return}if(D.value===""){alert("상세주소를 입력해주세요");return}const s={name:A.value,addrName:M.value,phone:w.value,zipcode:g.value,addr:u.value,addrDetail:D.value};m.post("api/insertAddr",s).then(n=>{n.data==="success"&&location.reload()}).catch(n=>{if(console.log(n),n.response.data==="fail"){alert("주소 등록 실패");return}if(n.response.status===500){alert("서버 오류 발생");return}}),console.log(s)};return m.get("/api/selectReserves").then(s=>{console.log(s),y.value=s.data}).catch(s=>{if(console.log(s),s.response.status===500){alert("서버 오류 발생");return}}),W(h,s=>{y.value!==void 0&&s>y.value.reserves&&(alert("현재 적립금보다 많이 사용할 수 없습니다."),h.value=0)}),{addrList:p,addRadio:O,addrInfo:o,productList:t,getImageUrl:he,paymentBtn:S,getTotalPrice:U,req:B,payMethod:F,modal:I,zonecode:g,roadAddress:u,detailAddress:D,openPostcode:H,name:A,addrName:M,phone:w,saveAddr:T,addCommas:L,reservesInfo:y,useReserves:h,reserves:x}}};const l=p=>(ve("data-v-37267ff0"),p=p(),ge(),p),Be={key:0,class:"black-bg"},Ae={class:"white-bg"},ye=l(()=>e("h1",null,"신규 배송지",-1)),be=l(()=>e("span",null,"수령인",-1)),ke=l(()=>e("br",null,null,-1)),Fe=l(()=>e("span",null,"배송지명 (선택)",-1)),Ie=l(()=>e("br",null,null,-1)),we=l(()=>e("span",null,"휴대전화",-1)),xe=l(()=>e("br",null,null,-1)),Ee=l(()=>e("span",null,"배송지 주소",-1)),Ve=l(()=>e("br",null,null,-1)),je=l(()=>e("span",null,null,-1)),Me=l(()=>e("br",null,null,-1)),Re=l(()=>e("span",null,null,-1)),Ue=l(()=>e("hr",null,null,-1)),Pe=l(()=>e("h1",null,"Order / Payment",-1)),ze=l(()=>e("legend",null,"배송지 정보",-1)),Ne=l(()=>e("label",{for:"addr",class:"title"},"배송지",-1)),qe=["onClick"],Le=l(()=>e("label",{for:"tel2",class:"title"},"이름 / 연락처",-1)),Oe={key:0},Se={key:1},He=l(()=>e("label",{for:"comment",class:"title"},"주소",-1)),Te={key:0},Ge={key:1},Je=l(()=>e("label",{for:"comment",class:"title"},"배송 요청사항",-1)),Ke=l(()=>e("option",{value:"배송 시 요청사항을 선택해주세요"}," 배송 시 요청사항을 선택해주세요 ",-1)),Qe=l(()=>e("option",{value:"부재 시 경비실에 맡겨주세요"},"부재 시 경비실에 맡겨주세요",-1)),Xe=l(()=>e("option",{value:"부재 시 택배함에 넣어주세요"},"부재 시 택배함에 넣어주세요",-1)),We=l(()=>e("option",{value:"부재 시 집 앞에 놔주세요"},"부재 시 집 앞에 놔주세요",-1)),Ye=[Ke,Qe,Xe,We],Ze=l(()=>e("legend",null,"주문 정보",-1)),$e=l(()=>e("thead",null,[e("tr",null,[e("th",null,"상품정보"),e("th",null,"수량"),e("th",null,"적립금"),e("th",null,"상품 할인"),e("th",null,"배송 그룹"),e("th",null,"배송비"),e("th",null,"주문금액")])],-1)),et={class:"item-info"},tt=["src"],ut=l(()=>e("br",null,null,-1)),ot=l(()=>e("td",null,"-0원",-1)),lt=l(()=>e("td",null,"무료",-1)),st=l(()=>e("legend",null,"적립금 할인",-1)),nt={key:0},at=l(()=>e("legend",null,"결제 정보",-1)),dt={style:{"padding-right":"10px"}},rt={style:{"padding-right":"10px"}},it={style:{"padding-right":"10px"}},Ct={class:"centered"};function ct(p,o,k,t,B,F){const I=P("HeaderView"),g=P("router-link");return C(),c(V,null,[e("header",null,[z(I)]),e("div",null,[t.modal===!0?(C(),c("div",Be,[e("div",Ae,[e("button",{type:"button",onClick:o[0]||(o[0]=u=>t.modal=!1),style:{float:"right"}},"X"),ye,e("label",null,[be,r(),_(e("input",{type:"text","onUpdate:modelValue":o[1]||(o[1]=u=>t.name=u)},null,512),[[v,t.name]])]),r(),ke,e("label",null,[Fe,r(),_(e("input",{type:"text","onUpdate:modelValue":o[2]||(o[2]=u=>t.addrName=u)},null,512),[[v,t.addrName]])]),r(),Ie,e("label",null,[we,r(),_(e("input",{type:"text","onUpdate:modelValue":o[3]||(o[3]=u=>t.phone=u)},null,512),[[v,t.phone]])]),r(),xe,e("label",null,[Ee,_(e("input",{type:"text",placeholder:"우편번호","onUpdate:modelValue":o[4]||(o[4]=u=>t.zonecode=u),readonly:""},null,512),[[v,t.zonecode]]),e("button",{id:"postcode",onClick:o[5]||(o[5]=(...u)=>t.openPostcode&&t.openPostcode(...u))},"검색"),Ve,je,_(e("input",{type:"text","onUpdate:modelValue":o[6]||(o[6]=u=>t.roadAddress=u),placeholder:"주소",readonly:""},null,512),[[v,t.roadAddress]]),Me,Re,_(e("input",{type:"text","onUpdate:modelValue":o[7]||(o[7]=u=>t.detailAddress=u),placeholder:"상세주소"},null,512),[[v,t.detailAddress]])]),Ue,e("button",{type:"button",onClick:o[8]||(o[8]=u=>t.modal=!1),style:{"margin-right":"10px"}},"취소"),e("button",{type:"button",onClick:o[9]||(o[9]=(...u)=>t.saveAddr&&t.saveAddr(...u))},"저장")])])):N("",!0),Pe,e("form",null,[e("fieldset",null,[ze,e("ul",null,[e("li",null,[Ne,(C(!0),c(V,null,q(t.addrList,(u,D)=>(C(),c("span",{key:D},[e("label",null,[e("input",{type:"radio",name:"chk_info",onClick:A=>t.addRadio(u.addrId)},null,8,qe),r(" "+i(u.addrName),1)])]))),128)),e("button",{type:"button",style:{"margin-left":"10px"},onClick:o[10]||(o[10]=u=>t.modal=!0)}," 신규 배송지 추가 ")]),e("li",null,[Le,t.addrInfo?(C(),c("p",Oe,i(t.addrInfo.name)+" / "+i(t.addrInfo.phone),1)):(C(),c("p",Se,"선택해주세요"))]),e("li",null,[He,t.addrInfo?(C(),c("p",Te," ("+i(t.addrInfo.zipcode)+") "+i(t.addrInfo.addr)+" "+i(t.addrInfo.addrDetail),1)):(C(),c("p",Ge,"선택해주세요"))]),e("li",null,[Je,_(e("select",{style:{width:"300px"},"onUpdate:modelValue":o[11]||(o[11]=u=>t.req=u)},Ye,512),[[De,t.req]])])])]),e("fieldset",null,[Ze,e("table",null,[$e,e("tbody",null,[(C(!0),c(V,null,q(t.productList,(u,D)=>(C(),c("tr",{key:D,class:"cart-item"},[e("td",et,[z(g,{to:{name:"productDetailView",query:{id:u.productId}}},{default:me(()=>[e("span",null,[e("img",{src:t.getImageUrl(u.img),style:{width:"80px"}},null,8,tt)]),ut]),_:2},1032,["to"]),r(" "+i(u.name),1)]),e("td",null,i(u.cnt)+"개",1),e("td",null,i(t.addCommas(u.cnt*u.price*.01))+"원",1),ot,e("td",null,"그룹"+i(D+1),1),lt,e("td",null,i(t.addCommas(u.cnt*u.price))+"원",1)]))),128))])])]),e("fieldset",null,[st,r(" 적립금 사용: "),_(e("input",{type:"text","onUpdate:modelValue":o[12]||(o[12]=u=>t.useReserves=u)},null,512),[[v,t.useReserves]]),r(" 현재 적립금 : "),t.reservesInfo?(C(),c("span",nt,i(t.reservesInfo.reserves),1)):N("",!0)]),e("fieldset",null,[at,e("label",dt,[_(e("input",{type:"radio",name:"chk_info1",value:"card",checked:"","onUpdate:modelValue":o[13]||(o[13]=u=>t.payMethod=u)},null,512),[[j,t.payMethod]]),r("카드")]),e("label",rt,[_(e("input",{type:"radio",name:"chk_info1",value:"account","onUpdate:modelValue":o[14]||(o[14]=u=>t.payMethod=u)},null,512),[[j,t.payMethod]]),r("가상계좌")]),e("label",it,[_(e("input",{type:"radio",name:"chk_info1",value:"phone","onUpdate:modelValue":o[15]||(o[15]=u=>t.payMethod=u)},null,512),[[j,t.payMethod]]),r("휴대폰")])]),e("div",Ct,[e("button",{onClick:o[16]||(o[16]=(...u)=>t.paymentBtn&&t.paymentBtn(...u)),type:"button",style:{cursor:"pointer","font-size":"20px",padding:"10px 20px",color:"white","background-color":"black"}},i(t.addCommas(t.getTotalPrice-t.useReserves))+"원 결제하기 ",1)])])])],64)}const Dt=pe(fe,[["render",ct],["__scopeId","data-v-37267ff0"]]);export{Dt as default};
