import{r as s,u as H,a as m,K,L as X,M as G,i as J,j as Q,k as W,l as Y,m as Z,n as $,q as ee,s as te,x as oe,y as ue,z as le,A as ne,B as se,C as ae,e as de,_ as re,E as Ce,o as i,c,b as e,f as d,w as _,v as g,D as M,F as R,d as N,t as r,N as ie,g as x,H as ce,I as _e,p as pe,h as De}from"./index-d96fb694.js";function me(p){return new URL(Object.assign({"/src/assets/images/검정 후드티.jpg":J,"/src/assets/images/검정 후드티2.jpg":Q,"/src/assets/images/검정 후드티3.jpg":W,"/src/assets/images/고양이 이미지.png":Y,"/src/assets/images/나이키 바지.jpg":Z,"/src/assets/images/마이페이지.png":$,"/src/assets/images/슬랙스.jpg":ee,"/src/assets/images/야구 잠바.jpg":te,"/src/assets/images/양털 후리스.jpg":oe,"/src/assets/images/청바지.jpg":ue,"/src/assets/images/체크셔츠.jpg":le,"/src/assets/images/패딩 조끼.jpg":ne,"/src/assets/images/회색 후드티.jpg":se,"/src/assets/images/회색 후드티2.jpg":ae})[`/src/assets/images/${p}`],self.location).href}const ge={setup(){const p=s([]),u=s(),f=H(),t=s([]),v=s("배송 시 요청사항을 선택해주세요"),y=s("card"),b=s(!1),o=s(""),D=s(""),h=s(""),k=s(""),E=s(""),F=s(""),B=s(),A=s(0);m.get("/api/selectAddrList").then(n=>{p.value=n.data}).catch(n=>{console.log(n)});const P=n=>n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),z=n=>{m.post("/api/selectAddrInfo",{addrId:n}).then(a=>{u.value=a.data}).catch(a=>{console.log(a)})},w=s([]);K(async()=>{const n=f.query.products;if(n){const C=n.toString().split(",").map(Number);w.value=C}const a={ids:w.value.join(",")};try{const C=await m.get("api/selectCartProduct",{params:a});t.value=C.data}catch(C){console.error("Error fetching products:",C)}});const q=async()=>{if(u.value==null)alert("배송지를 선택 해주세요");else{if(v.value==="배송 시 요청사항을 선택해주세요"){alert("요청사항을 선택해주세요");return}if(window.confirm("결제하시겠습니까?")){const a={name:u.value.name,addr:u.value.addr,addrDetail:u.value.addrDetail,phone:u.value.phone,zipcode:u.value.zipcode,req:v.value,price:V.value-A.value,paymentMethod:y.value};try{const C=await m.post("/api/order",a);if(console.log(C),C.data!==-1){const O=C.data,j=[];t.value.forEach(I=>{const T={orderId:O,productId:I.productId,price:I.price,cnt:I.cnt};j.push(T)});const U=await m.post("/api/orderDetail",j);console.log(U),U.data==="success"?(console.log("주문이 성공적으로 완료되었습니다."),de.push({name:"OrderListView",query:{id:f.query.id}})):console.error("상세 주문 정보 저장 실패")}else console.error("주문 저장 실패")}catch(C){console.error("주문 처리 중 오류 발생:",C)}}}},V=X(()=>t.value.reduce((n,a)=>n+a.cnt*a.price,0)),L=()=>{new window.daum.Postcode({oncomplete:n=>{o.value=n.zonecode,D.value=n.roadAddress}}).open()},S=()=>{if(k.value===""){alert("수령인을 입력해주세요");return}if(F.value===""){alert("휴대전화를 입력해주세요");return}if(o.value===""){alert("우편번호를 입력해주세요");return}if(D.value===""){alert("주소를 입력해주세요");return}if(h.value===""){alert("상세주소를 입력해주세요");return}const n={name:k.value,addrName:E.value,phone:F.value,zipcode:o.value,addr:D.value,addrDetail:h.value};m.post("api/insertAddr",n).then(a=>{a.data==="success"&&location.reload()}).catch(a=>{console.log(a)}),console.log(n)};return m.get("/api/selectReserves").then(n=>{console.log(n),B.value=n.data}).catch(n=>{console.log(n)}),G(A,n=>{if(B.value!==void 0&&n>B.value.reserves){alert("현재 적립금보다 많이 사용할 수 없습니다."),A.value=0;return}}),{addrList:p,addRadio:z,addrInfo:u,productList:t,getImageUrl:me,paymentBtn:q,getTotalPrice:V,req:v,payMethod:y,modal:b,zonecode:o,roadAddress:D,detailAddress:h,openPostcode:L,name:k,addrName:E,phone:F,saveAddr:S,addCommas:P,reservesInfo:B,useReserves:A}}};const l=p=>(pe("data-v-d42daa70"),p=p(),De(),p),ve={key:0,class:"black-bg"},he={class:"white-bg"},Be=l(()=>e("h1",null,"신규 배송지",-1)),Ae=l(()=>e("span",null,"수령인",-1)),fe=l(()=>e("br",null,null,-1)),ye=l(()=>e("span",null,"배송지명 (선택)",-1)),be=l(()=>e("br",null,null,-1)),ke=l(()=>e("span",null,"휴대전화",-1)),Fe=l(()=>e("br",null,null,-1)),Ie=l(()=>e("span",null,"배송지 주소",-1)),xe=l(()=>e("br",null,null,-1)),Ee=l(()=>e("span",null,null,-1)),we=l(()=>e("br",null,null,-1)),Ve=l(()=>e("span",null,null,-1)),je=l(()=>e("hr",null,null,-1)),Ue=l(()=>e("h1",null,"Order / Payment",-1)),Me=l(()=>e("legend",null,"배송지 정보",-1)),Re=l(()=>e("label",{for:"addr",class:"title"},"배송지",-1)),Ne=["onClick"],Pe=l(()=>e("label",{for:"tel2",class:"title"},"이름 / 연락처",-1)),ze={key:0},qe={key:1},Le=l(()=>e("label",{for:"comment",class:"title"},"주소",-1)),Se={key:0},Oe={key:1},Te=l(()=>e("label",{for:"comment",class:"title"},"배송 요청사항",-1)),He=l(()=>e("option",{value:"배송 시 요청사항을 선택해주세요"}," 배송 시 요청사항을 선택해주세요 ",-1)),Ke=l(()=>e("option",{value:"부재 시 경비실에 맡겨주세요"},"부재 시 경비실에 맡겨주세요",-1)),Xe=l(()=>e("option",{value:"부재 시 택배함에 넣어주세요"},"부재 시 택배함에 넣어주세요",-1)),Ge=l(()=>e("option",{value:"부재 시 집 앞에 놔주세요"},"부재 시 집 앞에 놔주세요",-1)),Je=[He,Ke,Xe,Ge],Qe=l(()=>e("legend",null,"주문 정보",-1)),We=l(()=>e("thead",null,[e("tr",null,[e("th",null,"상품정보"),e("th",null,"수량"),e("th",null,"적립금"),e("th",null,"상품 할인"),e("th",null,"배송 그룹"),e("th",null,"배송비"),e("th",null,"주문금액")])],-1)),Ye={class:"item-info"},Ze=["src"],$e=l(()=>e("br",null,null,-1)),et=l(()=>e("td",null,"-0원",-1)),tt=l(()=>e("td",null,"무료",-1)),ot=l(()=>e("legend",null,"적립금 할인",-1)),ut={key:0},lt=l(()=>e("legend",null,"결제 정보",-1)),nt={style:{"padding-right":"10px"}},st={style:{"padding-right":"10px"}},at={style:{"padding-right":"10px"}},dt={class:"centered"};function rt(p,u,f,t,v,y){const b=Ce("router-link");return i(),c("div",null,[t.modal===!0?(i(),c("div",ve,[e("div",he,[e("button",{type:"button",onClick:u[0]||(u[0]=o=>t.modal=!1),style:{float:"right"}},"X"),Be,e("label",null,[Ae,d(),_(e("input",{type:"text","onUpdate:modelValue":u[1]||(u[1]=o=>t.name=o)},null,512),[[g,t.name]])]),d(),fe,e("label",null,[ye,d(),_(e("input",{type:"text","onUpdate:modelValue":u[2]||(u[2]=o=>t.addrName=o)},null,512),[[g,t.addrName]])]),d(),be,e("label",null,[ke,d(),_(e("input",{type:"text","onUpdate:modelValue":u[3]||(u[3]=o=>t.phone=o)},null,512),[[g,t.phone]])]),d(),Fe,e("label",null,[Ie,_(e("input",{type:"text",placeholder:"우편번호","onUpdate:modelValue":u[4]||(u[4]=o=>t.zonecode=o),readonly:""},null,512),[[g,t.zonecode]]),e("button",{id:"postcode",onClick:u[5]||(u[5]=(...o)=>t.openPostcode&&t.openPostcode(...o))},"검색"),xe,Ee,_(e("input",{type:"text","onUpdate:modelValue":u[6]||(u[6]=o=>t.roadAddress=o),placeholder:"주소",readonly:""},null,512),[[g,t.roadAddress]]),we,Ve,_(e("input",{type:"text","onUpdate:modelValue":u[7]||(u[7]=o=>t.detailAddress=o),placeholder:"상세주소"},null,512),[[g,t.detailAddress]])]),je,e("button",{type:"button",onClick:u[8]||(u[8]=o=>t.modal=!1),style:{"margin-right":"10px"}},"취소"),e("button",{type:"button",onClick:u[9]||(u[9]=(...o)=>t.saveAddr&&t.saveAddr(...o))},"저장")])])):M("",!0),Ue,e("form",null,[e("fieldset",null,[Me,e("ul",null,[e("li",null,[Re,(i(!0),c(R,null,N(t.addrList,(o,D)=>(i(),c("span",{key:D},[e("label",null,[e("input",{type:"radio",name:"chk_info",onClick:h=>t.addRadio(o.addrId)},null,8,Ne),d(" "+r(o.addrName),1)])]))),128)),e("button",{type:"button",style:{"margin-left":"10px"},onClick:u[10]||(u[10]=o=>t.modal=!0)}," 신규 배송지 추가 ")]),e("li",null,[Pe,t.addrInfo?(i(),c("p",ze,r(t.addrInfo.name)+" / "+r(t.addrInfo.phone),1)):(i(),c("p",qe,"선택해주세요"))]),e("li",null,[Le,t.addrInfo?(i(),c("p",Se," ("+r(t.addrInfo.zipcode)+") "+r(t.addrInfo.addr)+" "+r(t.addrInfo.addrDetail),1)):(i(),c("p",Oe,"선택해주세요"))]),e("li",null,[Te,_(e("select",{style:{width:"300px"},"onUpdate:modelValue":u[11]||(u[11]=o=>t.req=o)},Je,512),[[ie,t.req]])])])]),e("fieldset",null,[Qe,e("table",null,[We,e("tbody",null,[(i(!0),c(R,null,N(t.productList,(o,D)=>(i(),c("tr",{key:D,class:"cart-item"},[e("td",Ye,[ce(b,{to:{name:"productDetailView",query:{id:o.productId}}},{default:_e(()=>[e("span",null,[e("img",{src:t.getImageUrl(o.img),style:{width:"80px"}},null,8,Ze)]),$e]),_:2},1032,["to"]),d(" "+r(o.name),1)]),e("td",null,r(o.cnt)+"개",1),e("td",null,r(t.addCommas(o.cnt*o.price*.01))+"원",1),et,e("td",null,"그룹"+r(D+1),1),tt,e("td",null,r(t.addCommas(o.cnt*o.price))+"원",1)]))),128))])])]),e("fieldset",null,[ot,d(" 적립금 사용: "),_(e("input",{type:"text","onUpdate:modelValue":u[12]||(u[12]=o=>t.useReserves=o)},null,512),[[g,t.useReserves]]),d(" 현재 적립금 : "),t.reservesInfo?(i(),c("span",ut,r(t.reservesInfo.reserves),1)):M("",!0)]),e("fieldset",null,[lt,e("label",nt,[_(e("input",{type:"radio",name:"chk_info1",value:"card",checked:"","onUpdate:modelValue":u[13]||(u[13]=o=>t.payMethod=o)},null,512),[[x,t.payMethod]]),d("카드")]),e("label",st,[_(e("input",{type:"radio",name:"chk_info1",value:"account","onUpdate:modelValue":u[14]||(u[14]=o=>t.payMethod=o)},null,512),[[x,t.payMethod]]),d("가상계좌")]),e("label",at,[_(e("input",{type:"radio",name:"chk_info1",value:"phone","onUpdate:modelValue":u[15]||(u[15]=o=>t.payMethod=o)},null,512),[[x,t.payMethod]]),d("휴대폰")])]),e("div",dt,[e("button",{onClick:u[16]||(u[16]=(...o)=>t.paymentBtn&&t.paymentBtn(...o)),type:"button",style:{cursor:"pointer","font-size":"20px",padding:"10px 20px",color:"white","background-color":"black"}},r(t.addCommas(t.getTotalPrice-t.useReserves))+"원 결제하기 ",1)])])])}const it=re(ge,[["render",rt],["__scopeId","data-v-d42daa70"]]);export{it as default};
